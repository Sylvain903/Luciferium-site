<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Test Sons et Déconnexion</title>
<style>
  body { background: #111; color: white; font-family: sans-serif; padding: 2rem; }
  button { font-size: 1.2rem; padding: 0.5rem 1rem; margin: 0.5rem; cursor: pointer; }
  #logoutBtn { display: none; }
</style>
</head>
<body>

<button id="loginBtn">Connexion</button>
<button id="logoutBtn">Déconnexion</button>

<audio id="doorSound" src="https://actions.google.com/sounds/v1/doors/door_creak_long.ogg" preload="auto"></audio>
<audio id="screamSound" src="https://actions.google.com/sounds/v1/human_voices/scream_female_short.ogg" preload="auto"></audio>

<script>
  const loginBtn = document.getElementById('loginBtn');
  const logoutBtn = document.getElementById('logoutBtn');
  const doorSound = document.getElementById('doorSound');
  const screamSound = document.getElementById('screamSound');

  function playSound(audioEl) {
    audioEl.currentTime = 0;
    const p = audioEl.play();
    if (p !== undefined) {
      p.catch(err => console.log("Erreur lecture son :", err));
    }
  }

  loginBtn.addEventListener('click', () => {
    console.log("Clic Connexion - lancement son porte");
    playSound(doorSound);
    // Simuler connexion
    localStorage.setItem('user', JSON.stringify({loggedIn: true}));
    loginBtn.style.display = 'none';
    logoutBtn.style.display = 'inline-block';
  });

  logoutBtn.addEventListener('click', () => {
    console.log("Clic Déconnexion - lancement son cri");
    playSound(screamSound);
    // Déconnexion après fin du son
    screamSound.onended = () => {
      console.log("Son cri fini, déconnexion effective");
      localStorage.removeItem('user');
      loginBtn.style.display = 'inline-block';
      logoutBtn.style.display = 'none';
    }
  });

  // Au chargement, afficher bon bouton selon état login
  window.onload = () => {
    const user = JSON.parse(localStorage.getItem('user'));
    if (user && user.loggedIn) {
      loginBtn.style.display = 'none';
      logoutBtn.style.display = 'inline-block';
      console.log("Utilisateur déjà connecté");
    } else {
      loginBtn.style.display = 'inline-block';
      logoutBtn.style.display = 'none';
      console.log("Utilisateur non connecté");
    }
  };
</script>

</body>
</html>
